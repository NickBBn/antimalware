//
// Created by niickson on 7/3/21.
//

#ifndef ANTIMALWARE_ANTIMALWARE_SERVER_HPP
#define ANTIMALWARE_ANTIMALWARE_SERVER_HPP
#include <iostream>
#include <iomanip>
#include <string>
#include <filesystem>
#include <string>
#include <fstream>
#include <chrono>
#include "nlohmann/json.hpp"

namespace fs = std::filesystem;

class antimalware_server {
public:
    std::string parse_request(const std::string& request);
    antimalware_server();
    void scan(const std::string& path_to_dir);
    void print_results(std::ostream& out) const;

private:
    void scan_file(const fs::path& file);
    fs::path directory;
    size_t suspicious_js;
    size_t suspicious_unix;
    size_t suspicious_mac;
    size_t err_count;
    size_t files_count;
    size_t microsec_time;
};


#endif // ANTIMALWARE_ANTIMALWARE_SERVER_HPP
